<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>浅谈文件与磁盘 | 锡城长颈鹿的博客</title><meta name="keywords" content="linux"><meta name="author" content="锡城长颈鹿"><meta name="copyright" content="锡城长颈鹿"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="文件与磁盘是系统管理中非常重要的概念，这篇博客总结一下在linux系统中的磁盘分区、配额，以及文件系统，LVM（可恶这篇写了真的很久，本来还计划写下RAID，下次一定）  一、磁盘（1）磁盘的基本组成磁盘中分为硬盘和软盘，现在更常用的时硬盘。硬盘主要有由盘片、机械手臂、磁头与主轴马达等组成。当然现在还出现了SSD固态硬盘，它的读写性能非常强悍，与上图展示的机械硬盘结构完全不同。机械硬盘中，数据主">
<meta property="og:type" content="article">
<meta property="og:title" content="浅谈文件与磁盘">
<meta property="og:url" content="http://xichengchangjinglu.github.io/2022/08/02/%E6%B5%85%E8%B0%88%E6%96%87%E4%BB%B6%E4%B8%8E%E7%A3%81%E7%9B%98/index.html">
<meta property="og:site_name" content="锡城长颈鹿的博客">
<meta property="og:description" content="文件与磁盘是系统管理中非常重要的概念，这篇博客总结一下在linux系统中的磁盘分区、配额，以及文件系统，LVM（可恶这篇写了真的很久，本来还计划写下RAID，下次一定）  一、磁盘（1）磁盘的基本组成磁盘中分为硬盘和软盘，现在更常用的时硬盘。硬盘主要有由盘片、机械手臂、磁头与主轴马达等组成。当然现在还出现了SSD固态硬盘，它的读写性能非常强悍，与上图展示的机械硬盘结构完全不同。机械硬盘中，数据主">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://th.bing.com/th/id/OIP.sKs2t9CWOLWCMgzyOFlCKQHaEo?pid=ImgDet&rs=1">
<meta property="article:published_time" content="2022-08-02T09:26:34.642Z">
<meta property="article:modified_time" content="2022-08-02T14:03:12.300Z">
<meta property="article:author" content="锡城长颈鹿">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://th.bing.com/th/id/OIP.sKs2t9CWOLWCMgzyOFlCKQHaEo?pid=ImgDet&rs=1"><link rel="shortcut icon" href="https://pic4.zhimg.com/v2-02a3ed4cbe7ddc41b144752c25388a7b_b.jpg"><link rel="canonical" href="http://xichengchangjinglu.github.io/2022/08/02/%E6%B5%85%E8%B0%88%E6%96%87%E4%BB%B6%E4%B8%8E%E7%A3%81%E7%9B%98/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '浅谈文件与磁盘',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-02 22:03:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pic4.zhimg.com/v2-02a3ed4cbe7ddc41b144752c25388a7b_b.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://th.bing.com/th/id/OIP.sKs2t9CWOLWCMgzyOFlCKQHaEo?pid=ImgDet&amp;rs=1')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">锡城长颈鹿的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">浅谈文件与磁盘</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-08-02T09:26:34.642Z" title="Created 2022-08-02 17:26:34">2022-08-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-08-02T14:03:12.300Z" title="Updated 2022-08-02 22:03:12">2022-08-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="浅谈文件与磁盘"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>文件与磁盘是系统管理中非常重要的概念，这篇博客总结一下在linux系统中的磁盘分区、配额，以及文件系统，LVM（可恶这篇写了真的很久，本来还计划写下RAID，<del>下次一定</del>）</p>
</blockquote>
<h2 id="一、磁盘"><a href="#一、磁盘" class="headerlink" title="一、磁盘"></a>一、磁盘</h2><h3 id="（1）磁盘的基本组成"><a href="#（1）磁盘的基本组成" class="headerlink" title="（1）磁盘的基本组成"></a>（1）磁盘的基本组成</h3><p><img src="https://pic1.zhimg.com/80/v2-f83f89d2c73c78ea3d6ece32180f735f_720w.jpg?source=1940ef5c" alt="image.png"><br>磁盘中分为硬盘和软盘，现在更常用的时硬盘。硬盘主要有由盘片、机械手臂、磁头与主轴马达等组成。当然现在还出现了SSD固态硬盘，它的读写性能非常强悍，与上图展示的机械硬盘结构完全不同。机械硬盘中，数据主要存储在盘片上，在读取数据时，盘片旋转，磁头臂就一圈圈的读取，从直观上我们可以看到，同样的一圈磁盘外圈会比磁盘内圈大，所以外圈可以存储更多的数据。当我们在探讨磁盘分区时，一定躲不了盘片，所以我们有必要对盘片的结构做进一步了解。<br><img src="https://pic1.zhimg.com/80/v2-ab7a612df8bc5fc013bb95abf8b8ae51_720w.jpg?source=1940ef5c" alt="image.png"><br>盘片上面又可细分出扇区与磁道两种单位， 其中扇区的物理量设计有两种大小，分别是 512Bytes 与 4KBytes。在实际数据存储中，各个扇区也在担任不同的角色，其中一些扇区会记录这个磁盘的分区情况以及各种信息，记录分区信息的我们把它叫做磁盘分区表，通常放在第一个扇区，下面就来探讨一下磁盘分区。</p>
<h3 id="（2）磁盘分区"><a href="#（2）磁盘分区" class="headerlink" title="（2）磁盘分区"></a>（2）磁盘分区</h3><p>在Windows系统中，我们常常会看到C盘，D盘等，也许在你拿到电脑之初，厂家会帮你自动设定好，或者你在自行加装机械硬盘时，需要手动设置分区，那么我们为什么要设置分区呢？<br>设想一下这个场景，如果你的家中不设立任何独立的房间，而是所有的房间都合并在了一起，那么你一定会生活乱了套。在计算机中也一样，如果你的某个分区受到了破坏，你只需要修复那个分区即可，而不需要把整个磁盘修复。还有一方面是可以提高你计算机的性能，寻找数据时只需要到某个特定的分区寻找即可。在上面已经谈到，磁盘利用磁盘分区表来记录分区信息，那么什么是磁盘分区表呢？<br>磁盘分区表是计算机安装系统的时候进行分区所保存的分区表，常见的分区方案有MBR分区表和GPT分区表。</p>
<h4 id="MBR分区表"><a href="#MBR分区表" class="headerlink" title="MBR分区表"></a>MBR分区表</h4><p>传统的分区方案（称为MBR分区方案）是将分区信息保存到磁盘的第一个扇区（MBR扇区）中的64个字节中，每个分区项占用16个字节，这16个字节中存有活动状态标志、文件系统标识、起止柱面号、磁头号、扇区号、隐含扇区数目（4个字节）、分区总扇区数目（4个字节）等内容。由于MBR扇区只有64个字节用于分区表，所以只能记录4个分区的信息。这就是硬盘主分区数目不能超过4个的原因。后来为了支持更多的分区，引入了扩展分区及逻辑分区的概念。但每个分区项仍用16个字节存储。<br><img src="https://pic1.zhimg.com/80/v2-2c27a103e7788771af57e4464a803bad_720w.jpg?source=1940ef5c"><br>想象一下我们把磁盘展开成长条状，开机管理程序纪录区与分区表则通通放在磁盘的第一个扇区， 这个扇区通常是 512Bytes 的大小 ，所以说，第一个扇区 512Bytes 会有这两个数据：</p>
<ul>
<li>主要开机记录区（Master Boot Record, MBR）：可以安装开机管理程序的地方，有446 Bytes</li>
<li>分区表（partition table）：记录整颗硬盘分区的状态，有64 Bytes</li>
</ul>
<p>由于分区表所在区块仅有64 Bytes容量，因此最多仅能有四组记录区，每组记录区记录了该区段的启始与结束的柱面号码。但其实在实际环境中，我们不可能只有四个分区，这就要谈到主要分区、延伸分区以及由延伸分区切割出来的逻辑分区。在上图中Partition3就是一个延伸分区，其中分割出了四个逻辑分区。</p>
<h4 id="GPT分区表"><a href="#GPT分区表" class="headerlink" title="GPT分区表"></a>GPT分区表</h4><p>与 MBR相比 GPT 使用了 34 个 LBA 区块来纪录分区信息，同时与GPT 除了前面 34 个 LBA 之外，整个磁盘的最后 33 个 LBA 也拿来作为另一个备份。同时GPT分区也在首部加入了MBR相容分区，这个相容模式仅放入一个特殊标志的分区，用来表示此磁盘为 GPT 格式之意。而不懂 GPT 分区表的磁盘管理程序， 就不会认识这颗磁盘。<br><img src="https://pic1.zhimg.com/80/v2-33b8fc11007162a7a22c7980f83e4eed_720w.jpg?source=1940ef5c"></p>
<h3 id="（3）磁盘分区实操"><a href="#（3）磁盘分区实操" class="headerlink" title="（3）磁盘分区实操"></a>（3）磁盘分区实操</h3><p>不同的磁盘分区方案适用不同的服务类型，由于linux中不同目录有明确的作用，所以我们需要根据目录类型来分配分区，至于linux的目录我们后面再讨论。</p>
<h4 id="查看当前磁盘分区"><a href="#查看当前磁盘分区" class="headerlink" title="查看当前磁盘分区"></a>查看当前磁盘分区</h4><p>我们可以使用lsblk指令来查看当前的系统分区，lsblk 可以看成“ list block device ”的缩写，就是列出所有储存设备的意思。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN <span class="built_in">RM</span>  SIZE RO <span class="built_in">TYPE</span> MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>   <span class="number">40</span>G  <span class="number">0</span> disk </span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">381</span>M  <span class="number">0</span> part /boot</span><br><span class="line">└─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span> <span class="number">24.2</span>G  <span class="number">0</span> part </span><br><span class="line">  ├─centos<span class="literal">-root</span> <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">  ├─centos<span class="literal">-swap</span> <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">956</span>M  <span class="number">0</span> lvm  [<span class="type">SWAP</span>]</span><br><span class="line">  ├─centos<span class="literal">-usr</span>  <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>  <span class="number">9.3</span>G  <span class="number">0</span> lvm  /usr</span><br><span class="line">  ├─centos<span class="literal">-var</span>  <span class="number">253</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /var</span><br><span class="line">  ├─centos<span class="literal">-tmp</span>  <span class="number">253</span>:<span class="number">4</span>    <span class="number">0</span>  <span class="number">1.9</span>G  <span class="number">0</span> lvm  /tmp</span><br><span class="line">  └─centos<span class="literal">-home</span> <span class="number">253</span>:<span class="number">5</span>    <span class="number">0</span>  <span class="number">4.7</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">4.4</span>G  <span class="number">0</span> rom  /run/media/huajianchun/CentOS <span class="number">7</span> x86_64</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们可以看到其中除了分区还出现了一个叫lvm的东西，这其实是逻辑卷，可以认为是一种特殊的分区，我们后面再详细讨论</p>
<h4 id="增删磁盘分区"><a href="#增删磁盘分区" class="headerlink" title="增删磁盘分区"></a>增删磁盘分区</h4><p>由于使用的分区表不同也存在着不同的分区工具，MBR 分区表使用 fdisk 分区， GPT 分区表使用 gdisk 分区。本文使用的MBR分区，所以采用fdisk工具，让我们来做做看。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># fdisk /dev/sda</span></span><br><span class="line">欢迎使用 fdisk (util<span class="literal">-linux</span> <span class="number">2.23</span>.<span class="number">2</span>)。</span><br><span class="line"></span><br><span class="line">更改将停留在内存中，直到您决定将更改写入磁盘。</span><br><span class="line">使用写入命令前请三思。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：m</span><br><span class="line">命令操作</span><br><span class="line">   a   toggle a bootable flag</span><br><span class="line">   b   edit bsd disklabel</span><br><span class="line">   c   toggle the dos compatibility flag</span><br><span class="line">   d   delete a partition</span><br><span class="line">   g   create a new empty GPT partition table</span><br><span class="line">   G   create an IRIX (SGI) partition table</span><br><span class="line">   l   list known partition types</span><br><span class="line">   m   print this menu</span><br><span class="line">   n   add a new partition</span><br><span class="line">   o   create a new empty DOS partition table</span><br><span class="line">   p   print the partition table</span><br><span class="line">   q   quit without saving changes</span><br><span class="line">   s   create a new empty Sun disklabel</span><br><span class="line">   t   change a partition<span class="string">&#x27;s system id</span></span><br><span class="line"><span class="string">   u   change display/entry units</span></span><br><span class="line"><span class="string">   v   verify the partition table</span></span><br><span class="line"><span class="string">   w   write table to disk and exit</span></span><br><span class="line"><span class="string">   x   extra functionality (experts only)</span></span><br></pre></td></tr></table></figure>
<p>fdisk工具有非常丰富的操作提示，我们只要根据它的文字提示操作即可。如果想要新增一个分区，看到文字提示n   add a new partition，所以我们输入n并看看新增前后的分区对比，这里新增了一个大小为1GB的分区。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">命令(输入 m 获取帮助)：p</span><br><span class="line"></span><br><span class="line">磁盘 /dev/sda：<span class="number">42.9</span> GB, <span class="number">42949672960</span> 字节，<span class="number">83886080</span> 个扇区</span><br><span class="line">Units = 扇区 of <span class="number">1</span> * <span class="number">512</span> = <span class="number">512</span> bytes</span><br><span class="line">扇区大小(逻辑/物理)：<span class="number">512</span> 字节 / <span class="number">512</span> 字节</span><br><span class="line">I/O 大小(最小/最佳)：<span class="number">512</span> 字节 / <span class="number">512</span> 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：<span class="number">0</span>x0003ed2a</span><br><span class="line"></span><br><span class="line">   设备 Boot      <span class="built_in">Start</span>         <span class="keyword">End</span>      Blocks   Id  System</span><br><span class="line">/dev/sda1   *        <span class="number">2048</span>      <span class="number">782335</span>      <span class="number">390144</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda2          <span class="number">782336</span>    <span class="number">51605503</span>    <span class="number">25411584</span>   <span class="number">8</span>e  Linux LVM</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：n</span><br><span class="line">Partition <span class="built_in">type</span>:</span><br><span class="line">   p   primary (<span class="number">2</span> primary, <span class="number">0</span> extended, <span class="number">2</span> free)</span><br><span class="line">   e   extended</span><br><span class="line"><span class="built_in">Select</span> (default p): p</span><br><span class="line">分区号 (<span class="number">3</span>,<span class="number">4</span>，默认 <span class="number">3</span>)：<span class="number">3</span></span><br><span class="line">起始 扇区 (<span class="number">51605504</span><span class="literal">-83886079</span>，默认为 <span class="number">51605504</span>)：</span><br><span class="line">将使用默认值 <span class="number">51605504</span></span><br><span class="line">Last 扇区, +扇区 or +size&#123;K,M,G&#125; (<span class="number">51605504</span><span class="literal">-83886079</span>，默认为 <span class="number">83886079</span>)：+<span class="number">1</span>GB</span><br><span class="line">分区 <span class="number">3</span> 已设置为 Linux 类型，大小设为 <span class="number">954</span> MiB</span><br><span class="line"></span><br><span class="line">命令(输入 m 获取帮助)：p</span><br><span class="line"></span><br><span class="line">磁盘 /dev/sda：<span class="number">42.9</span> GB, <span class="number">42949672960</span> 字节，<span class="number">83886080</span> 个扇区</span><br><span class="line">Units = 扇区 of <span class="number">1</span> * <span class="number">512</span> = <span class="number">512</span> bytes</span><br><span class="line">扇区大小(逻辑/物理)：<span class="number">512</span> 字节 / <span class="number">512</span> 字节</span><br><span class="line">I/O 大小(最小/最佳)：<span class="number">512</span> 字节 / <span class="number">512</span> 字节</span><br><span class="line">磁盘标签类型：dos</span><br><span class="line">磁盘标识符：<span class="number">0</span>x0003ed2a</span><br><span class="line"></span><br><span class="line">   设备 Boot      <span class="built_in">Start</span>         <span class="keyword">End</span>      Blocks   Id  System</span><br><span class="line">/dev/sda1   *        <span class="number">2048</span>      <span class="number">782335</span>      <span class="number">390144</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda2          <span class="number">782336</span>    <span class="number">51605503</span>    <span class="number">25411584</span>   <span class="number">8</span>e  Linux LVM</span><br><span class="line">/dev/sda3        <span class="number">51605504</span>    <span class="number">53559295</span>      <span class="number">976896</span>   <span class="number">83</span>  Linux</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但当我们写入推出后，会惊讶的发现磁盘分区信息并没有发生改变，这是为什么呢，我们在前面提到磁盘的分区信息由分区记录表来记录，所以我们在更改后也需要更新分区表，这里使用partprobe指令即可，通过前后对比可以明显看出差异。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN <span class="built_in">RM</span>  SIZE RO <span class="built_in">TYPE</span> MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>   <span class="number">40</span>G  <span class="number">0</span> disk </span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">381</span>M  <span class="number">0</span> part /boot</span><br><span class="line">└─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span> <span class="number">24.2</span>G  <span class="number">0</span> part </span><br><span class="line">  ├─centos<span class="literal">-root</span> <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">  ├─centos<span class="literal">-swap</span> <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">956</span>M  <span class="number">0</span> lvm  [<span class="type">SWAP</span>]</span><br><span class="line">  ├─centos<span class="literal">-usr</span>  <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>  <span class="number">9.3</span>G  <span class="number">0</span> lvm  /usr</span><br><span class="line">  ├─centos<span class="literal">-var</span>  <span class="number">253</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /var</span><br><span class="line">  ├─centos<span class="literal">-tmp</span>  <span class="number">253</span>:<span class="number">4</span>    <span class="number">0</span>  <span class="number">1.9</span>G  <span class="number">0</span> lvm  /tmp</span><br><span class="line">  └─centos<span class="literal">-home</span> <span class="number">253</span>:<span class="number">5</span>    <span class="number">0</span>  <span class="number">4.7</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">4.4</span>G  <span class="number">0</span> rom  /run/media/huajianchun/CentOS <span class="number">7</span> x86_64</span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># partprobe -s</span></span><br><span class="line">/dev/sda: msdos partitions <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">Warning: 无法以读写方式打开 /dev/sr0 (只读文件系统)。/dev/sr0 已按照只读方式打开。</span><br><span class="line">/dev/sr0: msdos partitions <span class="number">2</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN <span class="built_in">RM</span>  SIZE RO <span class="built_in">TYPE</span> MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>   <span class="number">40</span>G  <span class="number">0</span> disk </span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">381</span>M  <span class="number">0</span> part /boot</span><br><span class="line">├─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span> <span class="number">24.2</span>G  <span class="number">0</span> part </span><br><span class="line">│ ├─centos<span class="literal">-root</span> <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">│ ├─centos<span class="literal">-swap</span> <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">956</span>M  <span class="number">0</span> lvm  [<span class="type">SWAP</span>]</span><br><span class="line">│ ├─centos<span class="literal">-usr</span>  <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>  <span class="number">9.3</span>G  <span class="number">0</span> lvm  /usr</span><br><span class="line">│ ├─centos<span class="literal">-var</span>  <span class="number">253</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /var</span><br><span class="line">│ ├─centos<span class="literal">-tmp</span>  <span class="number">253</span>:<span class="number">4</span>    <span class="number">0</span>  <span class="number">1.9</span>G  <span class="number">0</span> lvm  /tmp</span><br><span class="line">│ └─centos<span class="literal">-home</span> <span class="number">253</span>:<span class="number">5</span>    <span class="number">0</span>  <span class="number">4.7</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">└─sda3            <span class="number">8</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">954</span>M  <span class="number">0</span> part </span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">4.4</span>G  <span class="number">0</span> rom  /run/media/huajianchun/CentOS <span class="number">7</span> x86_64</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="（4）磁盘配额"><a href="#（4）磁盘配额" class="headerlink" title="（4）磁盘配额"></a>（4）磁盘配额</h3><p>想象这样一个场景，当你设定了一个1GB的分区，其中有五位用户在使用这个分区，理想状态是，这五位用户平分这1GB的空间，但偏偏有用户恶意使用，一个人独占800MB该怎么办，由此我们便要讨论磁盘配额，对用户或者目录进行限制，避免这一情况发生。在linux中，有一个名为quota的工具可以解决这一问题。因为Linux是多用户多任务的操作系统，许多人共用磁盘空间，为了合理的分配磁盘空间，于是就有了quota的出现。<br>我们首先要介绍柔性劝导（soft）与硬性规定（hard）这两个概念，hard表示绝对的限制，举个例子来说就是，如果限制为500MB，那么你的文件大小无论如何都不能超过500MB，所谓soft可以理解为一个警戒值，假如你的hard设置为500MB，soft设置为400MB，那么当你的文件大小超过400MB但没有达到500MB时会受到警告，这个警告通常有个时限被叫做grace time，一旦超过时限，你的hard也会变成400MB，目录被锁住，你就无法再进行操作了。<br><img src="https://picx.zhimg.com/80/v2-cc6dbb899b053779bf39853143ff805c_720w.jpg?source=1940ef5c" alt="image.png"><br>我提前创建好了五个用户命名为quotatest1，quotatest2，quotatest3，quotatest4，quotatest5并将他们加入quotatest群组。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">quotatest1</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="variable">$</span> id</span><br><span class="line">uid=<span class="number">1002</span>(quotatest1) gid=<span class="number">1002</span>(quotatest) 组=<span class="number">1002</span>(quotatest)</span><br></pre></td></tr></table></figure>
<p>我们还需要修改&#x2F;etc&#x2F;fstab文件来打开quota功能，并进行重新挂载</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># vim /etc/fstab</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># cat /etc/fstab </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Fri Jul 29 17:12:39 2022</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-root</span> /                       xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">UUID=<span class="number">8809</span>eae2<span class="literal">-0ea5-4d53-bc0a-284678c4bd41</span> /boot                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-home</span> /home                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-tmp</span>  /tmp                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-usr</span>  /usr                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-var</span>  /var                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-swap</span> swap                    swap    defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/sda3               /<span class="keyword">data</span>/sda3              xfs     defaults,usrquota,grpquota        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># umount /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># mount -a</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># mount | grep /data/sda3</span></span><br><span class="line">/dev/sda3 on /<span class="keyword">data</span>/sda3 <span class="built_in">type</span> xfs (rw,relatime,attr2,inode64,usrquota,grpquota)</span><br></pre></td></tr></table></figure>
<p>下面我们要进行配额的设置</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M quotatest1&quot; /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M quotatest2&quot; /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M quotatest3&quot; /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M quotatest4&quot; /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;limit -u bsoft=250M bhard=300M quotatest5&quot; /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">tmp</span>]<span class="comment"># xfs_quota -x -c &quot;report -ubih&quot; /data/sda3</span></span><br><span class="line">User quota on /<span class="keyword">data</span>/sda3 (/dev/sda3)</span><br><span class="line">                        Blocks                            Inodes              </span><br><span class="line">User ID      Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  </span><br><span class="line"><span class="literal">----------</span> <span class="literal">---------------------------------</span> <span class="literal">---------------------------------</span> </span><br><span class="line">root            <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]      <span class="number">4</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br><span class="line">quotatest1      <span class="number">0</span>   <span class="number">250</span>M   <span class="number">300</span>M  <span class="number">00</span> [------]      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br><span class="line">quotatest2      <span class="number">0</span>   <span class="number">250</span>M   <span class="number">300</span>M  <span class="number">00</span> [------]      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br><span class="line">quotatest3      <span class="number">0</span>   <span class="number">250</span>M   <span class="number">300</span>M  <span class="number">00</span> [------]      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br><span class="line">quotatest4      <span class="number">0</span>   <span class="number">250</span>M   <span class="number">300</span>M  <span class="number">00</span> [------]      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br><span class="line">quotatest5      <span class="number">0</span>   <span class="number">250</span>M   <span class="number">300</span>M  <span class="number">00</span> [------]      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>  <span class="number">00</span> [------]</span><br></pre></td></tr></table></figure>
<h2 id="二、文件"><a href="#二、文件" class="headerlink" title="二、文件"></a>二、文件</h2><h3 id="（1）文件系统层次结构"><a href="#（1）文件系统层次结构" class="headerlink" title="（1）文件系统层次结构"></a>（1）文件系统层次结构</h3><p>在linux系统中，我们知道它并没有C盘，D盘等，那么文件目录的结构是什么样的呢。在linux的各大发行版中都遵循着一个目录配置标准，就是Filesystem Hierarchy Standard （FHS）标准，这个标准规定了linux的文件系统层次结构，让不同的发行版之间有了统一的标准。</p>
<blockquote>
<p>FHS：<a target="_blank" rel="noopener" href="https://refspecs.linuxfoundation.org/FHS_3.0/fhs/index.html">https://refspecs.linuxfoundation.org/FHS_3.0&#x2F;fhs&#x2F;index.html</a></p>
</blockquote>
<p>整个系统的文件都从 &#x2F;（根目录）开始由于这个结构特别像一颗树从下往上开始分叉，于是我们又形象的把它叫做目录树，我们介绍几个其中的目录。<br><img src="https://pic3.zhimg.com/80/v2-6df7121f4faa11eaf7ab2d5facba9b03_720w.jpg?source=1940ef5c"><br>etc目录是配置文件目录，系统主要的配置文件几乎都放置在这个目录内，例如人员的帐号密码档、 各种服务的启始档等等。一般来说，这个目录下的各文件属性是可以让一般使用者查阅的， 但是只有root有权力修改。<br>home目录这是系统默认的使用者主文件夹。当你新增一个用户时，该用户的主文件夹会放置到该目录下。<br>usr目录并不是user的缩写，所以其中放置的并不是用户数据。usr是Unix Software Resource的缩写，其中放置的是软件数据。<br>在上图中我们可以看到几个箭头，这是什么意思呢，在windows中，当我们想打开一个软件时，通常不会一层层的进入目录寻找可执行文件，而是会选择在桌面放置一个快捷方式。类比这样的思想，我们也可以把这样的箭头认为是快捷方式，例如&#x2F;bin目录的箭头指向了&#x2F;usr&#x2F;sbin，那么就说明&#x2F;bin目录下存放的内容就是&#x2F;usr&#x2F;bin目录下存放的内容。</p>
<h3 id="（2）文件系统"><a href="#（2）文件系统" class="headerlink" title="（2）文件系统"></a>（2）文件系统</h3><p>那么既然是这样的结构，如何把它和我们之前谈到的磁盘联系起来呢，这里就要谈到一个叫文件系统的东西。文件系统是操作系统中负责管理持久数据的子系统，说简单点，就是负责把用户的文件存到磁盘硬件中，因为即使计算机断电了，磁盘里的数据并不会丢失，所以可以持久化的保存文件。文件系统的基本数据单位是文件，它的目的是对磁盘上的文件进行组织管理，那组织的方式不同，就会形成不同的文件系统。在centos系统中，文件系统经历了从Ext文件系统到xfs文件系统的变化。<br>谈到文件系统，我们就必须要谈到三个区块，分别是superblock、inode和block，其中superblock记录此 filesystem 的整体信息，包括inode&#x2F;block的总量、使用量、剩余量， 以及文件系统的格式与相关信息等。inode：记录文件的属性，一个文件占用一个inode，同时记录此文件的数据所在的 block 号。block实际记录文件的内容，若文件太大时，会占用多个 block 。<img src="https://pic2.zhimg.com/80/v2-3abaed9c57d14bde806f11cee2dc47e9_720w.jpg?source=1940ef5c" alt="image.png"></p>
<h4 id="EXT2文件系统简述"><a href="#EXT2文件系统简述" class="headerlink" title="EXT2文件系统简述"></a>EXT2文件系统简述</h4><p>EXT2文件系统采用一个叫块组的东西，即block group。如下图所示，在文件系统的最前面会有一个Boot Block开机扇区，后面被分成了多个块组。每个块组的结构相同。通过这种结构可以高效的进行数据管理，就像班级一样，每个班级的结构相同，那么学校就很容易管理众多的学生。<br><img src="https://pic4.zhimg.com/80/v2-ba086b3cef5f4c81085eb5805cf11783_720w.jpg?source=1940ef5c"></p>
<h4 id="xfs文件系统简述"><a href="#xfs文件系统简述" class="headerlink" title="xfs文件系统简述"></a>xfs文件系统简述</h4><p>XFS是高性能文件系统，SGI为他们的IRIX平台而设计。自从2001年移植到Linux内核上，由于它的高性能，XFS成为了许多企业级系统的首选，特别是有大量数据，需要结构化伸缩性和稳定性的。例如，RHEL&#x2F;CentOS 7 和Oracle Linux将XFS作为默认文件系统，SUSE&#x2F;openSUSE已经为XFS做了长期支持。XFS有许多独特的性能提升功能使他从众多文件系统中脱颖而出，像可伸缩&#x2F;并行 IO，元数据日志，热碎片整理，IO 暂停&#x2F;恢复，延迟分配等。我们可以用xfs_info指令来查看xfs文件系统信息。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># xfs_info /dev/sda1</span></span><br><span class="line">meta<span class="literal">-data</span>=/dev/sda1              isize=<span class="number">512</span>    agcount=<span class="number">4</span>, agsize=<span class="number">24384</span> blks</span><br><span class="line">         =                       sectsz=<span class="number">512</span>   attr=<span class="number">2</span>, projid32bit=<span class="number">1</span></span><br><span class="line">         =                       crc=<span class="number">1</span>        finobt=<span class="number">0</span> spinodes=<span class="number">0</span></span><br><span class="line"><span class="keyword">data</span>     =                       bsize=<span class="number">4096</span>   blocks=<span class="number">97536</span>, imaxpct=<span class="number">25</span></span><br><span class="line">         =                       sunit=<span class="number">0</span>      swidth=<span class="number">0</span> blks</span><br><span class="line">naming   =version <span class="number">2</span>              bsize=<span class="number">4096</span>   ascii<span class="literal">-ci</span>=<span class="number">0</span> ftype=<span class="number">1</span></span><br><span class="line">log      =internal               bsize=<span class="number">4096</span>   blocks=<span class="number">855</span>, version=<span class="number">2</span></span><br><span class="line">         =                       sectsz=<span class="number">512</span>   sunit=<span class="number">0</span> blks, lazy<span class="literal">-count</span>=<span class="number">1</span></span><br><span class="line">realtime =none                   extsz=<span class="number">4096</span>   blocks=<span class="number">0</span>, rtextents=<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="（3）文件系统与目录和磁盘间的关系"><a href="#（3）文件系统与目录和磁盘间的关系" class="headerlink" title="（3）文件系统与目录和磁盘间的关系"></a>（3）文件系统与目录和磁盘间的关系</h3><p>让我们想象一下这个场景，假如你想要购买一个房子，你可以选择房子所处的位置，你也可以选择如何使用这个房子。类比这三者的关系，磁盘代表位置，你可以选择目录存储在哪个磁盘中，文件系统则决定了你如何使用这个目录。还记得我们之前创建了一个分区吗，现在我们要将它格式化并挂载到一个目录下。<br>我们常常会听到格式化这三个字，格式化是指对磁盘或磁盘中的分区进行初始化的一种操作，这种操作通常会导致现有的磁盘或分区中所有的文件被清除。但在这里我们的分区中很干净并没有文件，所以我们格式化的目的在于该分区中创建一个文件系统，我们可以用mkfs.xfs创建一个xfs文件系统。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> <span class="type">dev</span>]<span class="comment"># mkfs.xfs /dev/sda3</span></span><br><span class="line">meta<span class="literal">-data</span>=/dev/sda3              isize=<span class="number">512</span>    agcount=<span class="number">4</span>, agsize=<span class="number">61056</span> blks</span><br><span class="line">         =                       sectsz=<span class="number">512</span>   attr=<span class="number">2</span>, projid32bit=<span class="number">1</span></span><br><span class="line">         =                       crc=<span class="number">1</span>        finobt=<span class="number">0</span>, sparse=<span class="number">0</span></span><br><span class="line"><span class="keyword">data</span>     =                       bsize=<span class="number">4096</span>   blocks=<span class="number">244224</span>, imaxpct=<span class="number">25</span></span><br><span class="line">         =                       sunit=<span class="number">0</span>      swidth=<span class="number">0</span> blks</span><br><span class="line">naming   =version <span class="number">2</span>              bsize=<span class="number">4096</span>   ascii<span class="literal">-ci</span>=<span class="number">0</span> ftype=<span class="number">1</span></span><br><span class="line">log      =internal log           bsize=<span class="number">4096</span>   blocks=<span class="number">855</span>, version=<span class="number">2</span></span><br><span class="line">         =                       sectsz=<span class="number">512</span>   sunit=<span class="number">0</span> blks, lazy<span class="literal">-count</span>=<span class="number">1</span></span><br><span class="line">realtime =none                   extsz=<span class="number">4096</span>   blocks=<span class="number">0</span>, rtextents=<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>格式化结束后我们就可以进行挂载，但是要注意，如果原来的某一目录已经被挂载的话，那如果你用新的分区再次挂载这个目录，那么这个目录里面的内容就会被覆盖。我们可以用mount指令进行挂载，并通过修改&#x2F;etc&#x2F;fstab文件设置开机挂载。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># mkdir -p data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># mount /dev/sda3 /data/sda3</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN <span class="built_in">RM</span>  SIZE RO <span class="built_in">TYPE</span> MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>   <span class="number">40</span>G  <span class="number">0</span> disk </span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">381</span>M  <span class="number">0</span> part /boot</span><br><span class="line">├─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span> <span class="number">24.2</span>G  <span class="number">0</span> part </span><br><span class="line">│ ├─centos<span class="literal">-root</span> <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">│ ├─centos<span class="literal">-swap</span> <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">956</span>M  <span class="number">0</span> lvm  [<span class="type">SWAP</span>]</span><br><span class="line">│ ├─centos<span class="literal">-usr</span>  <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>  <span class="number">9.3</span>G  <span class="number">0</span> lvm  /usr</span><br><span class="line">│ ├─centos<span class="literal">-var</span>  <span class="number">253</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /var</span><br><span class="line">│ ├─centos<span class="literal">-tmp</span>  <span class="number">253</span>:<span class="number">4</span>    <span class="number">0</span>  <span class="number">1.9</span>G  <span class="number">0</span> lvm  /tmp</span><br><span class="line">│ └─centos<span class="literal">-home</span> <span class="number">253</span>:<span class="number">5</span>    <span class="number">0</span>  <span class="number">4.7</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">└─sda3            <span class="number">8</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">954</span>M  <span class="number">0</span> part /<span class="keyword">data</span>/sda3</span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">4.4</span>G  <span class="number">0</span> rom  /run/media/huajianchun/CentOS <span class="number">7</span> x86_64</span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># cat /etc/fstab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Fri Jul 29 17:12:39 2022</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-root</span> /                       xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">UUID=<span class="number">8809</span>eae2<span class="literal">-0ea5-4d53-bc0a-284678c4bd41</span> /boot                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-home</span> /home                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-tmp</span>  /tmp                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-usr</span>  /usr                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-var</span>  /var                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-swap</span> swap                    swap    defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># vim /etc/fstab </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># cat /etc/fstab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Fri Jul 29 17:12:39 2022</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-root</span> /                       xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">UUID=<span class="number">8809</span>eae2<span class="literal">-0ea5-4d53-bc0a-284678c4bd41</span> /boot                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-home</span> /home                   xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-tmp</span>  /tmp                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-usr</span>  /usr                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-var</span>  /var                    xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/mapper/centos<span class="literal">-swap</span> swap                    swap    defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">/dev/sda3               /<span class="keyword">data</span>/sda3              xfs     defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># mount -a</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">MiWiFi</span>-<span class="type">R3</span>-<span class="type">srv</span> /]<span class="comment"># lsblk</span></span><br><span class="line">NAME            MAJ:MIN <span class="built_in">RM</span>  SIZE RO <span class="built_in">TYPE</span> MOUNTPOINT</span><br><span class="line">sda               <span class="number">8</span>:<span class="number">0</span>    <span class="number">0</span>   <span class="number">40</span>G  <span class="number">0</span> disk </span><br><span class="line">├─sda1            <span class="number">8</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">381</span>M  <span class="number">0</span> part /boot</span><br><span class="line">├─sda2            <span class="number">8</span>:<span class="number">2</span>    <span class="number">0</span> <span class="number">24.2</span>G  <span class="number">0</span> part </span><br><span class="line">│ ├─centos<span class="literal">-root</span> <span class="number">253</span>:<span class="number">0</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /</span><br><span class="line">│ ├─centos<span class="literal">-swap</span> <span class="number">253</span>:<span class="number">1</span>    <span class="number">0</span>  <span class="number">956</span>M  <span class="number">0</span> lvm  [<span class="type">SWAP</span>]</span><br><span class="line">│ ├─centos<span class="literal">-usr</span>  <span class="number">253</span>:<span class="number">2</span>    <span class="number">0</span>  <span class="number">9.3</span>G  <span class="number">0</span> lvm  /usr</span><br><span class="line">│ ├─centos<span class="literal">-var</span>  <span class="number">253</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">3.7</span>G  <span class="number">0</span> lvm  /var</span><br><span class="line">│ ├─centos<span class="literal">-tmp</span>  <span class="number">253</span>:<span class="number">4</span>    <span class="number">0</span>  <span class="number">1.9</span>G  <span class="number">0</span> lvm  /tmp</span><br><span class="line">│ └─centos<span class="literal">-home</span> <span class="number">253</span>:<span class="number">5</span>    <span class="number">0</span>  <span class="number">4.7</span>G  <span class="number">0</span> lvm  /home</span><br><span class="line">└─sda3            <span class="number">8</span>:<span class="number">3</span>    <span class="number">0</span>  <span class="number">954</span>M  <span class="number">0</span> part /<span class="keyword">data</span>/sda3</span><br><span class="line">sr0              <span class="number">11</span>:<span class="number">0</span>    <span class="number">1</span>  <span class="number">4.4</span>G  <span class="number">0</span> rom  /run/media/huajianchun/CentOS <span class="number">7</span> x86_64</span><br></pre></td></tr></table></figure>
<h2 id="三、LVM"><a href="#三、LVM" class="headerlink" title="三、LVM"></a>三、LVM</h2><p>我们可以对磁盘进行分区管理，那么我们也一定能对分区进行进一步管理，由此我们开始讨论LVM。LVM是Linux环境下对磁盘分区进行管理的一种机制，它由Heinz Mauelshagen在Linux 2.4内核上实现，我们常常难以评估各分区大小，以分配合适的硬盘空间。普通的磁盘分区管理方式在逻辑分区划分好之后就无法改变其大小，当一个逻辑分区存放不下某个文件时，这个文件因为受上层文件系统的限制，也不能跨越多个分区来存放，所以也不能同时放到别的磁盘上。如果我们使用LVM，这些问题就都迎刃而解，我们在无需停机的情况下可以方便地调整各个分区大小。</p>
<h3 id="（1）VG、LV、PV和PE"><a href="#（1）VG、LV、PV和PE" class="headerlink" title="（1）VG、LV、PV和PE"></a>（1）VG、LV、PV和PE</h3><p>我们需要先理解四个概念VG、LV、PV和PE</p>
<ul>
<li>PE（physical extend，物理区域）：物理区域是物理卷中可用于分配的最小存储单元，物理区域大小在建立卷组时指定，一旦确定不能更改，同一卷组所有物理卷的物理区域大小需一致，新的pv加入到vg后，pe的大小自动更改为vg中定义的pe大小</li>
<li>PV（phsical volume,物理卷）：是VG的组成部分，在逻辑卷管理系统的最底层，可为整个物理硬盘或硬盘上的分区</li>
<li>LV（logical volumn，逻辑卷 ）：逻辑卷建立在卷组基础上，卷组中未分配空间用于建立新的逻辑卷，建立后可动态添加卷到卷组中，逻辑卷建立后可以动态扩展和缩小空间，在逻辑卷上可以建立文件系统。</li>
<li>VG（volume group，卷组 ）：建立在物理卷上，一卷组至少包含一个物理卷，卷组建立后可动态添加卷到卷组，一个逻辑卷管理系统有多个卷组，LVM卷组由一个或多个物理卷组成<img src="https://pic4.zhimg.com/80/v2-06ed6035cfdcefcdd3abe1edd32b3c93_720w.jpg?source=1940ef5c"></li>
</ul>
<h3 id="（2）LV建立过程"><a href="#（2）LV建立过程" class="headerlink" title="（2）LV建立过程"></a>（2）LV建立过程</h3><p>通俗来说如果我们要建立一个LV即逻辑卷，那么我们一定会经历以下步骤。首先我们需要用fdisk&#x2F;gdisk工具把分区的System ID改为8e，将该分区类型变为Linux LVm。至于为什么是8e，请看如下展示，根据fdisk&#x2F;gdisk的文字提示即可查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">空                 24  NEC DOS         81  Minix / 旧 Linu bf  Solaris        </span><br><span class="line">1  FAT12           27  隐藏的 NTFS Win 82  Linux 交换 / So c1  DRDOS/sec (FAT-</span><br><span class="line">2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec (FAT-</span><br><span class="line">3  XENIX usr       3c  PartitionMagic  84  OS/2 隐藏的 C:  c6  DRDOS/sec (FAT-</span><br><span class="line">4  FAT16 &lt;32M      40  Venix 80286     85  Linux 扩展      c7  Syrinx         </span><br><span class="line">5  扩展            41  PPC PReP Boot   86  NTFS 卷集       da  非文件系统数据 </span><br><span class="line">6  FAT16           42  SFS             87  NTFS 卷集       db  CP/M / CTOS / .</span><br><span class="line">7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux 纯文本    de  Dell 工具      </span><br><span class="line">8  AIX             4e  QNX4.x 第2部分  8e  Linux LVM       df  BootIt         </span><br><span class="line">9  AIX 可启动      4f  QNX4.x 第3部分  93  Amoeba          e1  DOS 访问       </span><br><span class="line">a  OS/2 启动管理器 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O        </span><br><span class="line">b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor      </span><br><span class="line">c  W95 FAT32 (LBA) 52  CP/M            a0  IBM Thinkpad 休 eb  BeOS fs        </span><br><span class="line">e  W95 FAT16 (LBA) 53  OnTrack DM6 Aux a5  FreeBSD         ee  GPT            </span><br><span class="line">f  W95 扩展 (LBA)  54  OnTrackDM6      a6  OpenBSD         ef  EFI (FAT-12/16/</span><br><span class="line">10  OPUS            55  EZ-Drive        a7  NeXTSTEP        f0  Linux/PA-RISC  </span><br><span class="line">11  隐藏的 FAT12    56  Golden Bow      a8  Darwin UFS      f1  SpeedStor      </span><br><span class="line">12  Compaq 诊断     5c  Priam Edisk     a9  NetBSD          f4  SpeedStor      </span><br><span class="line">14  隐藏的 FAT16 &lt;3 61  SpeedStor       ab  Darwin 启动     f2  DOS 次要       </span><br><span class="line">16  隐藏的 FAT16    63  GNU HURD or Sys af  HFS / HFS+      fb  VMware VMFS    </span><br><span class="line">17  隐藏的 HPFS/NTF 64  Novell Netware  b7  BSDI fs         fc  VMware VMKCORE </span><br><span class="line">18  AST 智能睡眠    65  Novell Netware  b8  BSDI swap       fd  Linux raid 自动</span><br><span class="line">1b  隐藏的 W95 FAT3 70  DiskSecure 多启 bb  Boot Wizard 隐  fe  LANstep        </span><br><span class="line">1c  隐藏的 W95 FAT3 75  PC/IX           be  Solaris 启动    ff  BBT            </span><br><span class="line">1e  隐藏的 W95 FAT1 80  旧 Minix   </span><br></pre></td></tr></table></figure>
<p>然后我们要将多个PV形成一个VG，即把多个分区变为一个卷组。最后我们把该卷组分出多个逻辑卷（LV），用先前同样的方法格式化挂载即可使用。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://xichengchangjinglu.github.io">锡城长颈鹿</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://xichengchangjinglu.github.io/2022/08/02/%E6%B5%85%E8%B0%88%E6%96%87%E4%BB%B6%E4%B8%8E%E7%A3%81%E7%9B%98/">http://xichengchangjinglu.github.io/2022/08/02/%E6%B5%85%E8%B0%88%E6%96%87%E4%BB%B6%E4%B8%8E%E7%A3%81%E7%9B%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux</a></div><div class="post_share"><div class="social-share" data-image="https://th.bing.com/th/id/OIP.sKs2t9CWOLWCMgzyOFlCKQHaEo?pid=ImgDet&amp;rs=1" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/12/%5B%5D.slice.call()%E7%9A%84%E4%BD%9C%E7%94%A8/"><img class="prev-cover" src="https://res.cloudinary.com/teepublic/image/private/s--HGX34F_2--/t_Preview/b_rgb:ffb81c,c_lpad,f_jpg,h_630,q_90,w_1200/v1539273850/production/designs/3302095_0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">[].slice.call()的作用</div></div></a></div><div class="next-post pull-right"><a href="/2022/07/31/%E5%B0%8F%E7%99%BD%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8C%97%EF%BC%88%E7%BA%AF%E5%B0%8F%E7%99%BD%EF%BC%89/"><img class="next-cover" src="https://pica.zhimg.com/v2-d4c1239e75c02e8482c22017a6c8d407_1440w.jpg?source=172ae18b" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">小白搭建博客不完全指北（纯小白）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/09/14/YUM%E8%BD%AF%E4%BB%B6%E6%BA%90%E9%85%8D%E7%BD%AE/" title="YUM软件源配置"><img class="cover" src="https://www.linuxidc.com/upload/2017_10/17100409209718.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-14</div><div class="title">YUM软件源配置</div></div></a></div><div><a href="/2022/08/15/samba%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/" title="samba服务配置实现文件共享"><img class="cover" src="https://www.leixue.com/uploads/2019/11/Samba.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-15</div><div class="title">samba服务配置实现文件共享</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pic4.zhimg.com/v2-02a3ed4cbe7ddc41b144752c25388a7b_b.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">锡城长颈鹿</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xichengchangjinglu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%A3%81%E7%9B%98"><span class="toc-number">1.</span> <span class="toc-text">一、磁盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%A3%81%E7%9B%98%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="toc-number">1.1.</span> <span class="toc-text">（1）磁盘的基本组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">1.2.</span> <span class="toc-text">（2）磁盘分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MBR%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">MBR分区表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GPT%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">GPT分区表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E5%AE%9E%E6%93%8D"><span class="toc-number">1.3.</span> <span class="toc-text">（3）磁盘分区实操</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.1.</span> <span class="toc-text">查看当前磁盘分区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%88%A0%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.2.</span> <span class="toc-text">增删磁盘分区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%884%EF%BC%89%E7%A3%81%E7%9B%98%E9%85%8D%E9%A2%9D"><span class="toc-number">1.4.</span> <span class="toc-text">（4）磁盘配额</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%96%87%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">二、文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text">（1）文件系统层次结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.2.</span> <span class="toc-text">（2）文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXT2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%80%E8%BF%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">EXT2文件系统简述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%80%E8%BF%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text">xfs文件系统简述</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%8E%E7%9B%AE%E5%BD%95%E5%92%8C%E7%A3%81%E7%9B%98%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.3.</span> <span class="toc-text">（3）文件系统与目录和磁盘间的关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81LVM"><span class="toc-number">3.</span> <span class="toc-text">三、LVM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%881%EF%BC%89VG%E3%80%81LV%E3%80%81PV%E5%92%8CPE"><span class="toc-number">3.1.</span> <span class="toc-text">（1）VG、LV、PV和PE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%882%EF%BC%89LV%E5%BB%BA%E7%AB%8B%E8%BF%87%E7%A8%8B"><span class="toc-number">3.2.</span> <span class="toc-text">（2）LV建立过程</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/10/11/git%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="git学习记录"><img src="https://th.bing.com/th/id/R.900dada55f12a39dbcd23cafcee06372?rik=EczTBk84CIgocQ&amp;riu=http%3a%2f%2fupload-images.jianshu.io%2fupload_images%2f166109-e49ba9e2ca4e3dfd.gif&amp;ehk=qdHwSESN1jQaZ9KQ7U3dta3d5fZqyDIhlPnPsbkaKIw%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git学习记录"/></a><div class="content"><a class="title" href="/2022/10/11/git%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="git学习记录">git学习记录</a><time datetime="2022-10-11T10:06:48.685Z" title="Created 2022-10-11 18:06:48">2022-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/14/YUM%E8%BD%AF%E4%BB%B6%E6%BA%90%E9%85%8D%E7%BD%AE/" title="YUM软件源配置"><img src="https://www.linuxidc.com/upload/2017_10/17100409209718.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="YUM软件源配置"/></a><div class="content"><a class="title" href="/2022/09/14/YUM%E8%BD%AF%E4%BB%B6%E6%BA%90%E9%85%8D%E7%BD%AE/" title="YUM软件源配置">YUM软件源配置</a><time datetime="2022-09-14T09:13:09.552Z" title="Created 2022-09-14 17:13:09">2022-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/09/Nginx%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" title="Nginx配置反向代理"><img src="https://img1.sycdn.imooc.com/5979e29e00010efd13500750.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx配置反向代理"/></a><div class="content"><a class="title" href="/2022/09/09/Nginx%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" title="Nginx配置反向代理">Nginx配置反向代理</a><time datetime="2022-09-09T01:47:22.966Z" title="Created 2022-09-09 09:47:22">2022-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/04/Nginx%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/" title="Nginx的基本配置"><img src="https://pic3.zhimg.com/v2-bfdefee39a52b1ab66af6ef1d29ef66e_1440w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx的基本配置"/></a><div class="content"><a class="title" href="/2022/09/04/Nginx%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/" title="Nginx的基本配置">Nginx的基本配置</a><time datetime="2022-09-04T07:00:30.480Z" title="Created 2022-09-04 15:00:30">2022-09-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/04/Nginx%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2/" title="Nginx的安装和部署"><img src="https://img.sj33.cn/uploads/202009/7-200923141040512.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx的安装和部署"/></a><div class="content"><a class="title" href="/2022/09/04/Nginx%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2/" title="Nginx的安装和部署">Nginx的安装和部署</a><time datetime="2022-09-04T04:19:11.789Z" title="Created 2022-09-04 12:19:11">2022-09-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 锡城长颈鹿</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>